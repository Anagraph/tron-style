layers:
    landuse:
        data: { source: mapzen }
        draw:
            polygons:
                order: global.order
                visible: false
        tier1:
            filter:
                any:
                    # limit show smaller landuse areas to higher zooms
                    - { $zoom: { min: 3 },  area: { min: 300000000 } }
                    - { $zoom: { min: 4 },  area: { min: 300000000 } }
                    - { $zoom: { min: 5 },  area: { min: 150000000 } }
                    - { $zoom: { min: 6 },  area: { min: 150000000 } }
                    - { $zoom: { min: 7 },  area: { min: 100000000 } }
                    - { $zoom: { min: 8 },  area: { min: 10000000 } }
                    - { $zoom: { min: 9 },  area: { min: 5000000 } }
                    - { $zoom: { min: 10 }, area: { min: 1000000 } }
                    - { $zoom: { min: 11 }, area: { min: 500000 } }
                    - { $zoom: { min: 12 }, area: { min: 500000 } }
                    - { $zoom: { min: 13 }, area: { min: 100000 } }
                    - { $zoom: { min: 14 }, area: { min: 50000 } }
                    - { $zoom: { min: 15 }, area: { min: 20000 } }
                    - { $zoom: { min: 15 }, area: { min: 2000 } }
                    - { $zoom: { min: 16 } }
            national_park:
                filter: { kind: [national_park, "park or protected land", battlefield], not: { operator: [ "United States Forest Service", "US Forest Service", "U.S. Forest Service", "USDA Forest Service" ] } }
                draw:
                    polygons:
                        style: landuse
                        # color: [0.263,0.933,0.494]
                        color: [0.402,0.568,0.818]
                        visible: true
                us_national_park:
                    # yosemite national park, death valley national park, grand canyon national park
                    filter: { operator: [ "United States National Park Service", "US National Park Service", "U.S. National Park Service" ] }
                    draw:
                        polygons:
                            # color: [0.214,0.690,0.611]
                            color: [0.340,0.703,1.000]
                            visible: true
        tier2:
            filter:
                any:
                    # limit show smaller landuse areas to higher zooms
                    - { $zoom: { min: 4 },  area: { min: 1000000000 } }
                    - { $zoom: { min: 5 },  area: { min: 1000000000 } }
                    - { $zoom: { min: 6 },  area: { min: 150000000 } }
                    - { $zoom: { min: 7 },  area: { min: 100000000 } }
                    - { $zoom: { min: 8 },  area: { min: 10000000 } }
                    - { $zoom: { min: 9 },  area: { min: 5000000 } }
                    - { $zoom: { min: 10 }, area: { min: 1000000 } }
                    - { $zoom: { min: 11 }, area: { min: 500000 } }
                    - { $zoom: { min: 12 }, area: { min: 250000 } }
                    - { $zoom: { min: 13 }, area: { min: 100000 } }
                    - { $zoom: { min: 14 }, area: { min: 50000 } }
                    - { $zoom: { min: 15 }, area: { min: 20000 } }
                    - { $zoom: { min: 15 }, area: { min: 2000 } }
                    - { $zoom: { min: 16 } }
            conservation:
                filter:
                    kind: [conservation, protected_area, nature_reserve]
                    $zoom: { min: 4 }
                draw:
                    polygons:
                        style: landuse-tier2-conservation-contours
                        # color: [0.214,0.690,0.611]
                        color: [0.000,0.649,0.829]
                        visible: true
                # wilderness_areas:
                #     filter: function() { return feature.name && feature.name.indexOf("Wilderness") > -1 }
                #     draw:
                #         polygons:
                #             style: landuse-tier2-conservation
                #             order: 25
                #             color: [0.216,0.392,0.720]
                #             visible: true
                # national_forest_level_6:
                #     filter: { protect_class: ["6",6] }
                #     draw:
                #         polygons:
                #             style: landuse-tier2-conservation
                #             color: red
                #             visible: true
            farm:
                filter:
                    kind: [farm, farmland]
                    $zoom: { min: 10 }
                draw:
                    polygons:
                        style: landuse-tier2-farm
                        color: [0.186,0.214,0.600]
                        visible: true
            forest:
                filter: { kind: [forest,wood], $zoom: { min: 6 } }
                national-forest:
                    filter:
                        operator: [ "United States Forest Service", "US Forest Service", "U.S. Forest Service", "USDA Forest Service" ]
                    draw:
                        polygons:
                            color: red
                            visible: true

                landuse-forest:
                    filter:
                        not: { operator: [ "United States Forest Service", "US Forest Service", "U.S. Forest Service", "USDA Forest Service" ] }
                        $zoom: { min: 6 }
                    draw:
                        polygons:
                            style: landuse
                            # color: [0.617,0.800,0.950]
                            color: [0.238,0.529,0.820]
                            visible: true

            nature_reserve:
                filter: { kind: nature_reserve, $zoom: { min: 7 } }
                wilderness-areas:
                    filter: function() { return feature.name && feature.name.indexOf("Wilderness") > -1 }
                    draw:
                        polygons:
                            color: [0.151,0.240,0.560]

            parks_and_national_forests_not_national_park:
                filter:
                    kind: [park, national_park, "park or protected land", battlefield]
                    not: { operator: [ "United States National Park Service", "US National Park Service" ] }
                    $zoom: { min: 4 }

                # default for national forests and more?
                draw:
                    polygons:
                        style: landuse
                        # color: [0.243,0.769,0.623]
                        # color: [0.243,0.769,0.949]
                        # color: [0.200,1.000,1.000]
                        color: [0.250,0.820,1.000]
                        visible: true
        tier3:
            filter:
                any:
                    # limit show smaller landuse areas to higher zooms
                    - { $zoom: { min: 8 },  area: { min: 10000000 } }
                    - { $zoom: { min: 9 },  area: { min: 5000000 } }
                    - { $zoom: { min: 10 }, area: { min: 1000000 } }
                    - { $zoom: { min: 11 }, area: { min: 500000 } }
                    - { $zoom: { min: 12 }, area: { min: 500000 } }
                    - { $zoom: { min: 13 }, area: { min: 100000 } }
                    - { $zoom: { min: 14 }, area: { min: 50000 } }
                    - { $zoom: { min: 15 }, area: { min: 20000 } }
                    - { $zoom: { min: 15 }, area: { min: 2000 } }
                    - { $zoom: { min: 16 } }

            # university:
            #     filter:
            #         kind: [university, college]
            #     draw:
            #         polygons:
            #             style: landuse-tier3-university
            #             color: yellow
            #             visible: true
        tier4:
            filter:
                any:
                    # limit show smaller landuse areas to higher zooms
                    - { $zoom: { min: 10 }, area: { min: 1000000 } }
                    - { $zoom: { min: 11 }, area: { min: 500000 } }
                    - { $zoom: { min: 12 }, area: { min: 500000 } }
                    - { $zoom: { min: 13 }, area: { min: 100000 } }
                    - { $zoom: { min: 14 }, area: { min: 50000 } }
                    - { $zoom: { min: 15 }, area: { min: 20000 } }
                    - { $zoom: { min: 15 }, area: { min: 2000 } }
                    - { $zoom: { min: 16 } }
            # golf_course:
            #     filter:
            #         kind: golf_course
            #     draw:
            #         polygons:
            #             style: landuse-tier4-golf_course
            #             color: [0.217,0.307,0.442]
            #             visible: true
            # industrial:
            #     filter:
            #         kind: industrial
            #     draw:
            #         polygons:
            #             style: landuse-tier4-industrial
            #             # color: [0.186,0.214,0.600]
            #             color: [0.191,0.316,0.490]
            #             # color: [0.240,0.264,0.600]
            #             visible: true
            power:
                filter:
                    kind: [plant, generator, substation]
                draw:
                    polygons:
                        style: landuse-tier4-power
                        color: [0.243,0.243,0.871]
                        visible: true
            man-made:
                filter: { kind: [pier,wastewater_plant,works,bridge,tower,breakwater,water_works,groyne,dike,cutline] }
                draw: 
                    polygons:
                        style: landuse-tier4-manmade
                        color: [0.048,0.301,0.631]
                        visible: true
                pier:
                    filter: { kind: [pier,bridge,breakwater,groyne,dike,cutline] }
                    draw:
                        polygons:
                            color: [0.048,0.301,0.631]
                            visible: true
styles:
    landuse:
        base: polygons
        mix: [functions-zoom, elevation-stripes]
        shaders:
            defines:
                ZOOM_START: 0.
                ZOOM_END: 13.
                STRIPES_ALPHA: .5
                STRIPES_SCALE: 60.
                STRIPES_PCT: 1.8
                STRIPES_WIDTH: mix( (1.-zoom()),
                                    dot((sampleRaster(int(NORMAL_TEXTURE_INDEX)).rgb-.5)*2.,
                                        STRIPES_DIR),
                                    zoom())*STRIPES_PCT

    landuse-tier2-farm:
        mix: [functions-zoom, polygons-stripes]
        blend: overlay
        shaders:
            defines:
                ZOOM_START: 10.
                ZOOM_END: 20.
                STRIPES_ANGLE: PI*0.95
                STRIPES_MAX: -.025
                STRIPES_ALPHA: .5
                STRIPES_WIDTH: zoom()
    landuse-tier2-conservation-contours:
        mix: [tron-palette, elevation-contours]
        animated: global.enable_animation
        shaders:
            defines:
                PI: 3.1415926535897932384626433832795
                CONTOURS_PALETTE_RANGE: 2.
                CONTOURS_BACKGROUND_COLOR: vec4(0.)
                CONTOURS_COLOR: vec4(palette(normal_elv_raster.a*PI*CONTOURS_PALETTE_RANGE+u_time*.5), 1.)
                CONTOURS_SCALE: 60.
                CONTOURS_SPEED: -0.1
                CONTOURS_OFFSET: u_time*CONTOURS_SPEED
    landuse-tier4-golf_course:
        mix: [functions-zoom, polygons-stripes]
        blend: overlay
        shaders:
            defines:
                ZOOM_START: 10.
                ZOOM_END: 20.
                STRIPES_ANGLE: PI*0.45
                STRIPES_MAX: -.025
                STRIPES_ALPHA: .8
                STRIPES_WIDTH: zoom()
    landuse-tier4-power:
        mix: [polygons-dots]
        blend: overlay
        shaders:
            defines:
                DOTS_COLOR: vec3(0.212,0.302,0.431)
                DOTS_SCALE: 10.
                DOTS_SIZE: 0.41
    landuse-tier4-manmade:
        base: polygons
        mix: [functions-zoom, polygons-diagonal-grid]
        shaders:
            defines:
                ZOOM_START: 14.
                ZOOM_END: 18.
                ZOOM_IN: .0
                ZOOM_OUT: 1.

                GRID_SCALE: 20.
                GRID_WIDTH: zoom()*.5

    landuse-tier4-industrial:
        base: polygons
        mix: [functions-zoom, polygons-diagonal-grid]
        shaders:
            defines:
                ZOOM_START: 14.
                ZOOM_END: 18.
                ZOOM_IN: .0
                ZOOM_OUT: 1.

                GRID_SCALE: 20.
                GRID_WIDTH: zoom()*.5
