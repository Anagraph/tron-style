layers:
    water:
        data: { source: mapzen }
        draw:
            polygons:
                style: water
                order: global.order
                # color: [0.219, 0.226, 0.529]
                color: [0.304,0.310,0.660]

        later:
            filter: { $zoom: { min: 13 } }
            draw:
                polygons:
                    style: water-later
                    color: [0.194,0.198,0.380]
                    # color: [0.219,0.226,0.430]

        lakes:
            filter:
                all:
                    - kind: [ocean, lake, water, riverbank, reservoir, swimming_pool]
                # WARNING: any area filters here must match the area filters in the water-boundaries-not_ocean layer
                any:
                    # limit show smaller landuse areas to higher zooms
                    - { $zoom: { min: 1 },  area: { min: 40000000000 } }
                    - { $zoom: { min: 2 },  area: { min: 20000000000 } }
                    # some weird natural earth scale set transition
                    - { $zoom: { min: 3 },  area: { min: 80000000000 } }
                    - { $zoom: { min: 4 },  area: { min: 5000000000 } }
                    - { $zoom: { min: 5 },  area: { min: 700000000 } }
                    - { $zoom: { min: 6 },  area: { min: 500000000 } }
                    - { $zoom: { min: 7 },  area: { min: 160000000 } }
                    - { $zoom: { min: 8 },  area: { min: 40000000 } }
                    - { $zoom: { min: 9 },  area: { min: 10000000 } }
                    - { $zoom: { min: 10 }, area: { min: 8000000 } }
                    - { $zoom: { min: 11 }, area: { min: 2000000 } }
                    - { $zoom: { min: 12 }, area: { min: 200000 } }
                    - { $zoom: { min: 13 }, area: { min: 100000 } }
                    - { $zoom: { min: 14 }, area: { min: 2000 } }
                    - { $zoom: { min: 15 } }
            draw:
                polygons:
                    style: water
                    # color: [0.219, 0.226, 0.529]
                    color: [0.304,0.310,0.660]

        other_areas:
            filter: { not: { kind: [ocean, lake, water, reservoir, playa] }, $zoom: { min: 10 }, area: { min: 100 } }
            draw:
                polygons:
                    style: water
                    color: [0.304,0.310,0.660]
            later:
                filter: { $zoom: { min: 13 } }
                draw:
                    polygons:
                        style: water-later
                        color: [0.194,0.198,0.380]

        swimming_pool:
            filter: { kind: swimming_pool }
            draw:
                polygons:
                    style: polygons
                    color: [0.000,0.804,0.776]

        boundaries:
            filter: { boundary: yes, kind: ocean }
            # don't animate early, save the fan, save the planet!
            early:
                filter: { $zoom: { max: 16 } }
                draw:
                    lines:
                        style: water-boundaries
                        order: global.order
                        width: [[4,0px],[11,4px],[14,12px],[16,16px],[18,24px],[20,30]]
                        color: [0.091,0.329,0.692]
                        join: round
            animated:
                filter: { $zoom: { min: 16 } }
                draw:
                    lines:
                        style: water-boundaries-animated
                        order: global.order
                        width: [[4,0px],[11,4px],[14,12px],[16,16px],[18,24px],[20,30]]
                        color: [0.091,0.329,0.692]
                        join: round

        boundaries-not_ocean:
            filter:
                all:
                    - boundary: yes
                    - not: { kind: [ocean, playa] }
                    - $zoom: { min: 8}
                # WARNING: any area filters here must match the area filters in the lakes layer
                any:
                    # limit show smaller landuse areas to higher zooms
                    - { $zoom: { min: 1 },  area: { min: 40000000000 } }
                    - { $zoom: { min: 2 },  area: { min: 20000000000 } }
                    # some weird natural earth scale set transition
                    - { $zoom: { min: 3 },  area: { min: 80000000000 } }
                    - { $zoom: { min: 4 },  area: { min: 5000000000 } }
                    - { $zoom: { min: 5 },  area: { min: 700000000 } }
                    - { $zoom: { min: 6 },  area: { min: 500000000 } }
                    - { $zoom: { min: 7 },  area: { min: 160000000 } }
                    - { $zoom: { min: 8 },  area: { min: 40000000 } }
                    - { $zoom: { min: 9 },  area: { min: 10000000 } }
                    - { $zoom: { min: 10 }, area: { min: 8000000 } }
                    - { $zoom: { min: 11 }, area: { min: 2000000 } }
                    - { $zoom: { min: 12 }, area: { min: 200000 } }
                    - { $zoom: { min: 13 }, area: { min: 100000 } }
                    - { $zoom: { min: 14 }, area: { min: 2000 } }
                    - { $zoom: { min: 15 } }
            draw:
                lines:
                    order: global.order
                    color: [0.155,0.482,0.910]
                    width: [[8,0px],[13,1px],[15,1.25px],[20,3px]]
                    join: round
            swimming_pool:
                filter: { kind: swimming_pool }
                draw:
                    lines:
                        style: swimming-pool-glow
                        color: [0.557,0.996,1.000]
                        width: [[8,0px],[13,3px],[15,4px],[20,12px]]
            boundaries-not_ocean-riverbank:
                # river boundaries like the thames in london, la seine in paris
                filter: { kind: riverbank }
                draw:
                    lines:
                        color: [0.155,0.482,0.910]
                        width: [[8,0px],[13,1px],[15,1.25px],[20,8px]]

styles:
    water:
        base: polygons
        mix: [functions-zoom, polygons-diagonal-stripes]
        shaders:
            defines:
                ZOOM_START: 3.
                ZOOM_END: 12.
                ZOOM_MAX: 14.
                ZOOM_IN: .9
                ZOOM_OUT: -.2

                STRIPES_ALPHA: .5
                STRIPES_SCALE: 20.
                STRIPES_WIDTH: zoom()

    water-later:
        base: polygons
        mix: [functions-zoom, polygons-shimmering]
        animated: true
        shaders:
            defines:
                ZOOM_START: 11.
                ZOOM_END: 16.

                SHIMMERING_SCALE: mix(10.,30.,zoom())
                SHIMMERING_BACKGROUND: vec3(0.145,0.157,0.247)
                SHIMMERING_SPEED: .5
                SHIMMERING_AMOUNT: zoom()
                SHIMMERING_ANIMATED: global.animated

    water-boundaries:
        base: lines
        mix: [lines-coast]
        animated: false
        shaders:
            defines:
                COAST_WAVES_ANIMATED: false
    water-boundaries-animated:
        base: lines
        mix: [lines-coast]
        animated: true
        shaders:
            defines:
                COAST_WAVES_ANIMATED: global.animated
    swimming-pool-glow:
        base: lines
        mix: [lines-glow]
        shaders:
            defines:
                GLOW_WIDTH: .75
                GLOW_BRIGHTNESS: .25